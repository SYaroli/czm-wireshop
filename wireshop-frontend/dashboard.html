<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>CZM • Wireshop Dashboard</title>
  <link rel="stylesheet" href="style.css"/>
</head>

<body>
  <div class="brand-bar">
    <div class="brand-inner">
      <a class="brand-logo" href="dashboard.html">
        <img src="czm-logo.png" alt="CZM">
        <h1 class="brand-title">CZM • Wireshop Dashboard</h1>
      </a>

      <div class="brand-actions" id="navActions">
        <a href="assignments.html" class="navbtn">Assignments (Build Next)</a>
        <a href="/inventory" class="navbtn">Inventory</a>
        <a href="admin.html" class="navbtn" id="adminNav" style="display:none;">Admin</a>
        <a href="index.html" class="navbtn" id="logoutNav">Logout</a>
      </div>
    </div>
  </div>

  <main class="page">
    <div class="card">
      <div><strong>Welcome,</strong> <span id="welcomeName"></span></div>
    </div>

    <div class="card">
      <h2 style="margin:0 0 10px 0;">Start / Update Job</h2>

      <div class="row" style="gap:10px; flex-wrap:wrap;">
        <label style="min-width:260px;">Part Number<br/>
          <select id="partSelect" class="inline-input"></select>
        </label>

        <label style="min-width:220px;">Action<br/>
          <select id="actionSelect" class="inline-input">
            <option value="Start">Start</option>
            <option value="Continue">Continue</option>
            <option value="Pause">Pause</option>
            <option value="Finish">Finish</option>
          </select>
        </label>

        <label style="flex:1; min-width:260px;">Notes<br/>
          <input id="noteInput" class="inline-input" placeholder="Optional note..." />
        </label>

        <button id="submitJob" class="btn primary">Submit</button>
      </div>

      <div id="jobMsg" style="margin-top:10px; opacity:.85;"></div>
    </div>

    <div class="card">
      <h2 style="margin:0 0 10px 0;">Current</h2>
      <div id="currentInfo" style="opacity:.9;">--</div>
      <div style="margin-top:8px; opacity:.8;">
        Expected Time: <span id="expectedTime">--</span>
      </div>
    </div>
  </main>

  <script>
    // Gate Admin link + set welcome name
    (function () {
      let user = {};
      try { user = JSON.parse(localStorage.getItem('user') || '{}'); } catch {}

      if (!user || !user.username) {
        location.href = 'index.html';
        return;
      }

      const role = String(user.role || 'tech').toLowerCase();
      const adminLink = document.getElementById('adminNav');
      if (adminLink) adminLink.style.display = (role === 'admin') ? '' : 'none';

      const w = document.getElementById('welcomeName');
      if (w) w.textContent = `${user.username} (${role})`;
    })();
  </script>

  <script src="script.js"></script>
</body>
</html>
