<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>CZM • Wireshop Dashboard</title>
  <link rel="stylesheet" href="style.css" />
  <style>
    /* small guard rails so the top bar stays clean */
    .brand-actions { display:flex; gap:10px; flex-wrap:wrap; justify-content:flex-end; }
  </style>
</head>
<body>
  <div class="brandbar">
    <a href="dashboard.html" class="brand">
      <img src="czm-logo.png" alt="CZM">
      <h1 class="brand-title">CZM • Wireshop</h1>
    </a>

    <div class="brand-actions" id="navActions">
      <a href="assignments.html" class="navbtn">Assignments (Build Next)</a>
      <a href="/inventory" class="navbtn">Inventory</a>
      <a href="admin.html" class="navbtn" id="adminNavBtn" style="display:none;">Admin</a>
      <a href="index.html" class="navbtn">Logout</a>
    </div>
  </div>

  <!-- Welcome strip -->
  <div class="card">
    <h2 style="margin:0 0 6px 0;">Dashboard</h2>
    <div id="welcomeLine" style="opacity:.9;"></div>
  </div>

  <!-- Start Job -->
  <div class="card">
    <h2 style="margin:0 0 10px 0;">Start / Update Job</h2>

    <div class="row" style="gap:10px; flex-wrap:wrap;">
      <label>Part Number<br/>
        <select id="partSelect" class="inline-input"></select>
      </label>

      <label>Action<br/>
        <select id="actionSelect" class="inline-input">
          <option value="Start">Start</option>
          <option value="Continue">Continue</option>
          <option value="Pause">Pause</option>
          <option value="Finish">Finish</option>
        </select>
      </label>

      <label>Notes<br/>
        <input id="noteInput" class="inline-input" placeholder="Optional note..." />
      </label>

      <button id="submitJob" class="navbtn">Submit</button>
    </div>

    <div id="jobMsg" style="margin-top:10px; opacity:.85;"></div>
  </div>

  <!-- Current job info -->
  <div class="card">
    <h2 style="margin:0 0 10px 0;">Current</h2>
    <div id="currentInfo" style="opacity:.9;">--</div>
    <div style="margin-top:8px; opacity:.8;">
      Expected Time: <span id="expectedTime">--</span>
    </div>
  </div>

  <script>
    // Minimal front-end gating for the Admin nav button
    (function () {
      const user = JSON.parse(localStorage.getItem('user') || '{}');
      const name = user.username ? String(user.username) : '';
      const role = user.role ? String(user.role).toLowerCase() : '';
      const isAdmin = role === 'admin';

      const adminBtn = document.getElementById('adminNavBtn');
      if (adminBtn) adminBtn.style.display = isAdmin ? '' : 'none';

      const welcome = document.getElementById('welcomeLine');
      if (welcome) welcome.textContent = name ? `Logged in as: ${name} (${role || 'tech'})` : 'Not logged in.';
    })();
  </script>

  <script src="script.js"></script>
</body>
</html>
